Calculating task graph as no cached configuration is available for tasks: :backend:test --tests sgc.security.ActuatorSecurityTest --tests sgc.integracao.CDU14IntegrationTest
> Task :backend:processResources UP-TO-DATE
> Task :backend:processTestResources UP-TO-DATE
> Task :backend:compileJava
> Task :backend:classes
> Task :backend:compileTestJava
> Task :backend:testClasses

> Task :backend:test

Testes de Segurança do Actuator > Deve negar acesso anônimo ao Actuator FAILED
    org.springframework.dao.DataIntegrityViolationException: could not execute statement [Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:1 */ CAST(1 AS BIGINT), 'Tribunal Regional Eleitoral', 'TRE', NULL, NULL, NULL, 'INTEROPERACIONAL', 'ATIVA', NULL)"; SQL statement:
    insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]] [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]; SQL [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]; constraint [SGC.CONSTRAINT_1A2 PRIMARY KEY]
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:169)
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:105)
        at app//org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
        at app//org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:556)
        at app//org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
        at app//org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:346)
        at app//org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:157)
        at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
        at app//org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:166)
        at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
        at app//org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
        at app/jdk.proxy3/jdk.proxy3.$Proxy217.save(Unknown Source)
        at app//sgc.security.ActuatorSecurityTest.setup(ActuatorSecurityTest.java:49)

        Caused by:
        org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:1 */ CAST(1 AS BIGINT), 'Tribunal Regional Eleitoral', 'TRE', NULL, NULL, NULL, 'INTEROPERACIONAL', 'ATIVA', NULL)"; SQL statement:
        insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]] [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]
            at app//org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$1(H2Dialect.java:845)
            at app//org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:34)
            at app//org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:115)
            at app//org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:193)
            at app//org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:103)
            at app//org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:45)
            at app//org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
            at app//org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:191)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:129)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:92)
            at app//org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:90)
            at app//org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:684)
            at app//org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:291)
            at app//org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:272)
            at app//org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:322)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:376)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:290)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:220)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:138)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:148)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:92)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:76)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:52)
            at app//org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:140)
            at app//org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:692)
            at app//org.hibernate.internal.SessionImpl.persist(SessionImpl.java:676)
            at java.base@21.0.8/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
            at java.base@21.0.8/java.lang.reflect.Method.invoke(Method.java:580)
            at app//org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:317)
            at app/jdk.proxy3/jdk.proxy3.$Proxy209.persist(Unknown Source)
            at app//org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:663)
            at java.base@21.0.8/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
            at java.base@21.0.8/java.lang.reflect.Method.invoke(Method.java:580)
            at app//org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:278)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:169)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
            at app//org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:545)
            at app//org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:290)
            at app//org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:708)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:171)
            at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:146)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
            at app//org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
            ... 6 more

            Caused by:
            org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:1 */ CAST(1 AS BIGINT), 'Tribunal Regional Eleitoral', 'TRE', NULL, NULL, NULL, 'INTEROPERACIONAL', 'ATIVA', NULL)"; SQL statement:
            insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]
                at app//org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
                at app//org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
                at app//org.h2.message.DbException.get(DbException.java:223)
                at app//org.h2.message.DbException.get(DbException.java:199)
                at app//org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
                at app//org.h2.mvstore.db.MVTable.addRow(MVTable.java:520)
                at app//org.h2.command.dml.Insert.insertRows(Insert.java:174)
                at app//org.h2.command.dml.Insert.update(Insert.java:135)
                at app//org.h2.command.CommandContainer.executeUpdateWithGeneratedKeys(CommandContainer.java:212)
                at app//org.h2.command.CommandContainer.update(CommandContainer.java:133)
                at app//org.h2.command.Command.executeUpdate(Command.java:306)
                at app//org.h2.command.Command.executeUpdate(Command.java:250)
                at app//org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
                at app//org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
                at app//com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
                at app//com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
                at app//org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:190)
                ... 53 more

Testes de Segurança do Actuator > Deve permitir acesso de ADMIN ao Actuator FAILED
    org.springframework.dao.DataIntegrityViolationException: could not execute statement [Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:2 */ CAST(2 AS BIGINT), U&'Secretaria de Inform\\00e1tica e Comunica\\00e7\\00f5es', 'STIC', NULL, '6', NULL, 'INTEROPERACIONAL', 'ATIVA', NULL)"; SQL statement:
    insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]] [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]; SQL [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]; constraint [SGC.CONSTRAINT_1A2 PRIMARY KEY]
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:169)
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:105)
        at app//org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
        at app//org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:556)
        at app//org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
        at app//org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:346)
        at app//org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:157)
        at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
        at app//org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:166)
        at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
        at app//org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
        at app/jdk.proxy3/jdk.proxy3.$Proxy217.save(Unknown Source)
        at app//sgc.security.ActuatorSecurityTest.setup(ActuatorSecurityTest.java:49)

        Caused by:
        org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:2 */ CAST(2 AS BIGINT), U&'Secretaria de Inform\\00e1tica e Comunica\\00e7\\00f5es', 'STIC', NULL, '6', NULL, 'INTEROPERACIONAL', 'ATIVA', NULL)"; SQL statement:
        insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]] [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]
            at app//org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$1(H2Dialect.java:845)
            at app//org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:34)
            at app//org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:115)
            at app//org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:193)
            at app//org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:103)
            at app//org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:45)
            at app//org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
            at app//org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:191)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:129)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:92)
            at app//org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:90)
            at app//org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:684)
            at app//org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:291)
            at app//org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:272)
            at app//org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:322)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:376)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:290)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:220)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:138)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:148)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:92)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:76)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:52)
            at app//org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:140)
            at app//org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:692)
            at app//org.hibernate.internal.SessionImpl.persist(SessionImpl.java:676)
            at java.base@21.0.8/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
            at java.base@21.0.8/java.lang.reflect.Method.invoke(Method.java:580)
            at app//org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:317)
            at app/jdk.proxy3/jdk.proxy3.$Proxy209.persist(Unknown Source)
            at app//org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:663)
            at java.base@21.0.8/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
            at java.base@21.0.8/java.lang.reflect.Method.invoke(Method.java:580)
            at app//org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:278)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:169)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
            at app//org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:545)
            at app//org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:290)
            at app//org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:708)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:171)
            at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:146)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
            at app//org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
            ... 6 more

            Caused by:
            org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:2 */ CAST(2 AS BIGINT), U&'Secretaria de Inform\\00e1tica e Comunica\\00e7\\00f5es', 'STIC', NULL, '6', NULL, 'INTEROPERACIONAL', 'ATIVA', NULL)"; SQL statement:
            insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]
                at app//org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
                at app//org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
                at app//org.h2.message.DbException.get(DbException.java:223)
                at app//org.h2.message.DbException.get(DbException.java:199)
                at app//org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
                at app//org.h2.mvstore.db.MVTable.addRow(MVTable.java:520)
                at app//org.h2.command.dml.Insert.insertRows(Insert.java:174)
                at app//org.h2.command.dml.Insert.update(Insert.java:135)
                at app//org.h2.command.CommandContainer.executeUpdateWithGeneratedKeys(CommandContainer.java:212)
                at app//org.h2.command.CommandContainer.update(CommandContainer.java:133)
                at app//org.h2.command.Command.executeUpdate(Command.java:306)
                at app//org.h2.command.Command.executeUpdate(Command.java:250)
                at app//org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
                at app//org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
                at app//com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
                at app//com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
                at app//org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:190)
                ... 53 more

Testes de Segurança do Actuator > Deve negar acesso de usuário comum ao Actuator FAILED
    org.springframework.dao.DataIntegrityViolationException: could not execute statement [Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:3 */ CAST(3 AS BIGINT), 'Coordenadoria de Administracao', 'COAD', NULL, NULL, NULL, 'INTERMEDIARIA', 'ATIVA', CAST(2 AS BIGINT))"; SQL statement:
    insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]] [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]; SQL [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]; constraint [SGC.CONSTRAINT_1A2 PRIMARY KEY]
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:169)
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
        at app//org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:105)
        at app//org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
        at app//org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:556)
        at app//org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
        at app//org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:346)
        at app//org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:157)
        at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
        at app//org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:166)
        at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
        at app//org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
        at app/jdk.proxy3/jdk.proxy3.$Proxy217.save(Unknown Source)
        at app//sgc.security.ActuatorSecurityTest.setup(ActuatorSecurityTest.java:49)

        Caused by:
        org.hibernate.exception.ConstraintViolationException: could not execute statement [Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:3 */ CAST(3 AS BIGINT), 'Coordenadoria de Administracao', 'COAD', NULL, NULL, NULL, 'INTERMEDIARIA', 'ATIVA', CAST(2 AS BIGINT))"; SQL statement:
        insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]] [insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default)]
            at app//org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$1(H2Dialect.java:845)
            at app//org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:34)
            at app//org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:115)
            at app//org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:193)
            at app//org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeysDelegate.java:103)
            at app//org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:45)
            at app//org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
            at app//org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:191)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:129)
            at app//org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:92)
            at app//org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:90)
            at app//org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:684)
            at app//org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:291)
            at app//org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:272)
            at app//org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:322)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:376)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:290)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:220)
            at app//org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:138)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:148)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:92)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:76)
            at app//org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:52)
            at app//org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:140)
            at app//org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:692)
            at app//org.hibernate.internal.SessionImpl.persist(SessionImpl.java:676)
            at java.base@21.0.8/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
            at java.base@21.0.8/java.lang.reflect.Method.invoke(Method.java:580)
            at app//org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:317)
            at app/jdk.proxy3/jdk.proxy3.$Proxy209.persist(Unknown Source)
            at app//org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:663)
            at java.base@21.0.8/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
            at java.base@21.0.8/java.lang.reflect.Method.invoke(Method.java:580)
            at app//org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:278)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:169)
            at app//org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
            at app//org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:545)
            at app//org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:290)
            at app//org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:708)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:171)
            at app//org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:146)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
            at app//org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
            at app//org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
            at app//org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:135)
            ... 6 more

            Caused by:
            org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Unique index or primary key violation: "SGC.CONSTRAINT_1A2 PRIMARY KEY ON SGC.VW_UNIDADE(CODIGO) ( /* key:3 */ CAST(3 AS BIGINT), 'Coordenadoria de Administracao', 'COAD', NULL, NULL, NULL, 'INTERMEDIARIA', 'ATIVA', CAST(2 AS BIGINT))"; SQL statement:
            insert into sgc.vw_unidade (data_inicio_titularidade,matricula_titular,nome,sigla,situacao,tipo,titulo_titular,unidade_superior_codigo,codigo) values (?,?,?,?,?,?,?,?,default) [23505-240]
                at app//org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
                at app//org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
                at app//org.h2.message.DbException.get(DbException.java:223)
                at app//org.h2.message.DbException.get(DbException.java:199)
                at app//org.h2.mvstore.db.MVPrimaryIndex.add(MVPrimaryIndex.java:121)
                at app//org.h2.mvstore.db.MVTable.addRow(MVTable.java:520)
                at app//org.h2.command.dml.Insert.insertRows(Insert.java:174)
                at app//org.h2.command.dml.Insert.update(Insert.java:135)
                at app//org.h2.command.CommandContainer.executeUpdateWithGeneratedKeys(CommandContainer.java:212)
                at app//org.h2.command.CommandContainer.update(CommandContainer.java:133)
                at app//org.h2.command.Command.executeUpdate(Command.java:306)
                at app//org.h2.command.Command.executeUpdate(Command.java:250)
                at app//org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
                at app//org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
                at app//com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
                at app//com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
                at app//org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:190)
                ... 53 more

CDU-14: Analisar revisão de cadastro de atividades e conhecimentos > Endpoints de Consulta > Deve retornar impactos no mapa corretamente FAILED
    java.lang.IllegalStateException: org.hibernate.TransientPropertyValueException: Persistent instance of 'sgc.atividade.model.Conhecimento' references an unsaved transient instance of 'sgc.atividade.model.Atividade' (persist the transient instance before flushing) [sgc.atividade.model.Conhecimento.atividade -> sgc.atividade.model.Atividade]
        at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:140)
        at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:155)
        at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:161)
        at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1451)
        at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1436)
        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
        at java.base/java.lang.reflect.Method.invoke(Method.java:580)
        at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:317)
        at jdk.proxy3/jdk.proxy3.$Proxy209.flush(Unknown Source)
        at sgc.integracao.CDU14IntegrationTest$EndpointsDeConsulta.deveRetornarImpactosNoMapa(CDU14IntegrationTest.java:411)

        Caused by:
        org.hibernate.TransientPropertyValueException: Persistent instance of 'sgc.atividade.model.Conhecimento' references an unsaved transient instance of 'sgc.atividade.model.Atividade' (persist the transient instance before flushing) [sgc.atividade.model.Conhecimento.atividade -> sgc.atividade.model.Atividade]
            at app//org.hibernate.engine.spi.CascadingActions$8.cascade(CascadingActions.java:406)
            at app//org.hibernate.engine.spi.CascadingActions$8.cascade(CascadingActions.java:385)
            at app//org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:538)
            at app//org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:446)
            at app//org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:222)
            at app//org.hibernate.engine.internal.Cascade.cascade(Cascade.java:163)
            at app//org.hibernate.event.internal.AbstractFlushingEventListener.checkForTransientReferences(AbstractFlushingEventListener.java:151)
            at app//org.hibernate.event.internal.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:140)
            at app//org.hibernate.event.internal.AbstractFlushingEventListener.preFlush(AbstractFlushingEventListener.java:89)
            at app//org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:68)
            at app//org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:38)
            at app//org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:140)
            at app//org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1447)
            ... 6 more

CDU-14: Analisar revisão de cadastro de atividades e conhecimentos > Fluxo de Homologação > ADMIN homologa COM impactos, alterando status e criando movimentação FAILED
    java.lang.IllegalStateException: org.hibernate.TransientPropertyValueException: Persistent instance of 'sgc.atividade.model.Conhecimento' references an unsaved transient instance of 'sgc.atividade.model.Atividade' (persist the transient instance before flushing) [sgc.atividade.model.Conhecimento.atividade -> sgc.atividade.model.Atividade]
        at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:140)
        at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:155)
        at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:161)
        at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1451)
        at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1436)
        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
        at java.base/java.lang.reflect.Method.invoke(Method.java:580)
        at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:317)
        at jdk.proxy3/jdk.proxy3.$Proxy209.flush(Unknown Source)
        at sgc.integracao.CDU14IntegrationTest$Homologacao.adminHomologaComImpactos(CDU14IntegrationTest.java:352)

        Caused by:
        org.hibernate.TransientPropertyValueException: Persistent instance of 'sgc.atividade.model.Conhecimento' references an unsaved transient instance of 'sgc.atividade.model.Atividade' (persist the transient instance before flushing) [sgc.atividade.model.Conhecimento.atividade -> sgc.atividade.model.Atividade]
            at app//org.hibernate.engine.spi.CascadingActions$8.cascade(CascadingActions.java:406)
            at app//org.hibernate.engine.spi.CascadingActions$8.cascade(CascadingActions.java:385)
            at app//org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:538)
            at app//org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:446)
            at app//org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:222)
            at app//org.hibernate.engine.internal.Cascade.cascade(Cascade.java:163)
            at app//org.hibernate.event.internal.AbstractFlushingEventListener.checkForTransientReferences(AbstractFlushingEventListener.java:151)
            at app//org.hibernate.event.internal.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:140)
            at app//org.hibernate.event.internal.AbstractFlushingEventListener.preFlush(AbstractFlushingEventListener.java:89)
            at app//org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:68)
            at app//org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:38)
            at app//org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:140)
            at app//org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1447)
            ... 6 more

11 tests completed, 5 failed

> Task :backend:test FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':backend:test'.
> There were failing tests. See the report at: file:///app/backend/build/reports/tests/test/index.html

* Try:
> Run with --scan to generate a Build Scan (powered by Develocity).

BUILD FAILED in 50s
5 actionable tasks: 3 executed, 2 up-to-date
Configuration cache entry stored.
