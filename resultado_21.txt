
> sgc@1.0.0 test:e2e
> playwright test e2e/cdu-21.spec.ts

[2m[WebServer] [22m[SMTP] Servidor SMTP local executando na porta 1025
[2m[WebServer] [22m[BACKEND] INFO  ValidadorDadosOrgService.run:80: Dados organizacionais validados com sucesso. 18 unidades verificadas.
[2m[WebServer] [22m[FRONTEND]   [32m[1mVITE[22m v7.3.1[39m  [2mready in [0m[1m358[22m[2m[0m ms[22m
[2m[WebServer] [22m[FRONTEND]   [32mâžœ[39m  [1mLocal[22m:   [36mhttp://localhost:[1m5173[22m/[39m
[2m[WebServer] [22m[FRONTEND] [2m  [32mâžœ[39m  [1mNetwork[22m[2m: use [22m[1m--host[22m[2m to expose[22m
[2m[WebServer] [22m>>> Frontend, Backend e SMTP no ar.

Running 14 tests using 1 worker

[2m[WebServer] [22m[BACKEND] INFO  E2eController.resetDatabase:61: Reset do banco de dados concluÃ­do.
[2m[WebServer] [22m[BACKEND] INFO  LoginFacade.entrar:115: UsuÃ¡rio 191919 autorizado: ADMIN-ADMIN
[2m[WebServer] [22m[BACKEND] INFO  ProcessoManutencaoService.criar:56: Processo 201 criado com 1 unidades participantes
[2m[WebServer] [22m[BACKEND] WARN  MonitoramentoAspect.monitorarExecucao:27: EXECUCAO LENTA: sgc.alerta.EmailModelosService.criarEmailInicioProcessoConsolidado levou 501 ms
[2m[WebServer] [22m[BACKEND] INFO  ProcessoNotificacaoService.enviarEmailEParaSubstituto:219: E-mail enviado para ADMIN
[2m[WebServer] [22m[BACKEND] INFO  ProcessoNotificacaoService.enviarEmailEParaSubstituto:219: E-mail enviado para COORD_22
[2m[WebServer] [22m[BACKEND] INFO  ProcessoNotificacaoService.enviarEmailEParaSubstituto:219: E-mail enviado para SECAO_221
[2m[WebServer] [22m[BACKEND] INFO  ProcessoNotificacaoService.enviarEmailEParaSubstituto:219: E-mail enviado para SECRETARIA_2
[2m[WebServer] [22m[BACKEND] WARN  MonitoramentoAspect.monitorarExecucao:27: EXECUCAO LENTA: sgc.processo.service.ProcessoNotificacaoService.emailInicioProcesso levou 647 ms
[2m[WebServer] [22m[BACKEND] INFO  ProcessoInicializador.iniciar:74: Processo de mapeamento 201 iniciado para 1 unidade(s): SECAO_221.
[2m[WebServer] [22m[BACKEND] INFO  E2eController.limparProcessoCompleto:115: Limpando processo 201 (modo robusto)
[2m[WebServer] [22m[BACKEND] INFO  E2eController.limparProcessoCompleto:153: Limpeza robusta do processo 201 concluÃ­da.
[2m[WebServer] [22m[BACKEND] ERROR RestExceptionHandler.handleGenericException:184: [9f68762c-0c34-44fd-990a-1fd1abe3d2e4] ERRO NÃƒO TRATADO DETECTADO: could not execute statement [Referential integrity constraint violation: "FK_ALERTA_USUARIO_ALERTA: SGC.ALERTA_USUARIO FOREIGN KEY(ALERTA_CODIGO) REFERENCES SGC.ALERTA(CODIGO) (CAST(3 AS BIGINT))"; SQL statement:
[2m[WebServer] [22m[BACKEND] insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?) [23506-240]] [insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?)]; SQL [insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?)]; constraint [FK_ALERTA_USUARIO_ALERTA]
[2m[WebServer] [22m[BACKEND] org.springframework.dao.DataIntegrityViolationException: could not execute statement [Referential integrity constraint violation: "FK_ALERTA_USUARIO_ALERTA: SGC.ALERTA_USUARIO FOREIGN KEY(ALERTA_CODIGO) REFERENCES SGC.ALERTA(CODIGO) (CAST(3 AS BIGINT))"; SQL statement:
[2m[WebServer] [22m[BACKEND] insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?) [23506-240]] [insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?)]; SQL [insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?)]; constraint [FK_ALERTA_USUARIO_ALERTA]
[2m[WebServer] [22m[BACKEND] 	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:169)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:105)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:223)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:687)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:408)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:130)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
[2m[WebServer] [22m[BACKEND] 	at sgc.processo.painel.PainelFacade$$SpringCGLIB$$0.listarAlertas(<generated>)
[2m[WebServer] [22m[BACKEND] 	at sgc.processo.painel.PainelController.listarAlertas(PainelController.java:55)
[2m[WebServer] [22m[BACKEND] 	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
[2m[WebServer] [22m[BACKEND] 	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:271)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:266)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
[2m[WebServer] [22m[BACKEND] 	at sgc.processo.painel.PainelController$$SpringCGLIB$$0.listarAlertas(<generated>)
[2m[WebServer] [22m[BACKEND] 	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
[2m[WebServer] [22m[BACKEND] 	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:252)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:184)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:934)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:853)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:86)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:963)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:866)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1000)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:892)
[2m[WebServer] [22m[BACKEND] 	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:633)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:874)
[2m[WebServer] [22m[BACKEND] 	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:723)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:128)
[2m[WebServer] [22m[BACKEND] 	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:107)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:107)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.servlet.resource.ResourceUrlEncodingFilter.doFilter(ResourceUrlEncodingFilter.java:66)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:107)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:235)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:493)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:354)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:86)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:132)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:101)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:181)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at sgc.seguranca.login.FiltroJwt.doFilterInternal(FiltroJwt.java:62)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:110)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:96)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:231)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:244)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:337)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:228)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:141)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:237)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:195)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.ServletRequestPathFilter.doFilter(ServletRequestPathFilter.java:52)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebSecurityConfiguration.java:317)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:355)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:272)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:107)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:107)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:107)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:107)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:199)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:107)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:77)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:492)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
[2m[WebServer] [22m[BACKEND] 	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341)
[2m[WebServer] [22m[BACKEND] 	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:397)
[2m[WebServer] [22m[BACKEND] 	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
[2m[WebServer] [22m[BACKEND] 	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
[2m[WebServer] [22m[BACKEND] 	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1779)
[2m[WebServer] [22m[BACKEND] 	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
[2m[WebServer] [22m[BACKEND] 	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:946)
[2m[WebServer] [22m[BACKEND] 	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:480)
[2m[WebServer] [22m[BACKEND] 	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:57)
[2m[WebServer] [22m[BACKEND] 	at java.base/java.lang.Thread.run(Thread.java:1583)
[2m[WebServer] [22m[BACKEND] Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Referential integrity constraint violation: "FK_ALERTA_USUARIO_ALERTA: SGC.ALERTA_USUARIO FOREIGN KEY(ALERTA_CODIGO) REFERENCES SGC.ALERTA(CODIGO) (CAST(3 AS BIGINT))"; SQL statement:
[2m[WebServer] [22m[BACKEND] insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?) [23506-240]] [insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?)]
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.dialect.H2Dialect.lambda$buildSQLExceptionConversionDelegate$0(H2Dialect.java:840)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:34)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:115)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:184)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:145)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:180)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:120)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:93)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:108)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)

[90m[[90m1:27:36 AM[90m][39m [41m[30m ERROR [39m[49m [BROWSER ERROR] Failed to load resource: the server responded with a status of 500 ()

[2m[WebServer] [22m[BACKEND] 	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
[2m[WebServer] [22m[BACKEND] 	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
[2m[WebServer] [22m[BACKEND] 	... 145 common frames omitted
[2m[WebServer] [22m[BACKEND] Caused by: org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Referential integrity constraint violation: "FK_ALERTA_USUARIO_ALERTA: SGC.ALERTA_USUARIO FOREIGN KEY(ALERTA_CODIGO) REFERENCES SGC.ALERTA(CODIGO) (CAST(3 AS BIGINT))"; SQL statement:
[2m[WebServer] [22m[BACKEND] insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?) [23506-240]
[2m[WebServer] [22m[BACKEND] 	at org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
[2m[WebServer] [22m[BACKEND] 	at org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
[2m[WebServer] [22m[BACKEND] 	at org.h2.message.DbException.get(DbException.java:223)
[2m[WebServer] [22m[BACKEND] 	at org.h2.message.DbException.get(DbException.java:199)
[2m[WebServer] [22m[BACKEND] 	at org.h2.constraint.ConstraintReferential.checkRowOwnTable(ConstraintReferential.java:309)
[2m[WebServer] [22m[BACKEND] 	at org.h2.constraint.ConstraintReferential.checkRow(ConstraintReferential.java:250)
[2m[WebServer] [22m[BACKEND] 	at org.h2.table.Table.fireConstraints(Table.java:1208)
[2m[WebServer] [22m[BACKEND] 	at org.h2.table.Table.fireAfterRow(Table.java:1226)
[2m[WebServer] [22m[BACKEND] 	at org.h2.command.dml.Insert.insertRows(Insert.java:188)
[2m[WebServer] [22m[BACKEND] 	at org.h2.command.dml.Insert.update(Insert.java:135)
[2m[WebServer] [22m[BACKEND] 	at org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:77)
[2m[WebServer] [22m[BACKEND] 	at org.h2.command.CommandContainer.update(CommandContainer.java:139)
[2m[WebServer] [22m[BACKEND] 	at org.h2.command.Command.executeUpdate(Command.java:306)
[2m[WebServer] [22m[BACKEND] 	at org.h2.command.Command.executeUpdate(Command.java:250)
[2m[WebServer] [22m[BACKEND] 	at org.h2.jdbc.JdbcPreparedStatement.executeUpdateInternal(JdbcPreparedStatement.java:213)
[2m[WebServer] [22m[BACKEND] 	at org.h2.jdbc.JdbcPreparedStatement.executeUpdate(JdbcPreparedStatement.java:172)
[2m[WebServer] [22m[BACKEND] 	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
[2m[WebServer] [22m[BACKEND] 	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
[2m[WebServer] [22m[BACKEND] 	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:181)
[2m[WebServer] [22m[BACKEND] 	... 168 common frames omitted

[90m[[90m1:27:37 AM[90m][39m [41m[30m ERROR [39m[49m [BROWSER UNCAUGHT ERROR] AxiosError: Request failed with status code 500
    at settle (http://localhost:5173/node_modules/.vite/deps/axios.js?v=0a1859fb:1319:7)
    at XMLHttpRequest.onloadend (http://localhost:5173/node_modules/.vite/deps/axios.js?v=0a1859fb:1682:7)
    at Axios.request (http://localhost:5173/node_modules/.vite/deps/axios.js?v=0a1859fb:2328:41)
    at async Module.listarAlertas (http://localhost:5173/src/services/painelService.ts:33:20)
    at async http://localhost:5173/src/stores/alertas.ts:12:24
    at async withErrorHandling (http://localhost:5173/src/composables/useErrorHandler.ts:11:14)
    at async Promise.all (index 1)
    at async carregarDados (http://localhost:5173/src/views/PainelView.vue:47:9)
    at async http://localhost:5173/src/views/PainelView.vue:51:7


[90m[[90m1:27:37 AM[90m][39m [43m[30m WARN [39m[49m [NETWORK ERROR] 500 GET http://localhost:10000/api/painel/alertas?page=0&size=10&usuarioTitulo=191919&unidade=1

[90m[[90m1:27:37 AM[90m][39m [36mâ„¹[39m [NETWORK BODY] {"code":"ERRO_INTERNO","details":{},"message":"ERRO INESPERADO: could not execute statement [Referential integrity constraint violation: \"FK_ALERTA_USUARIO_ALERTA: SGC.ALERTA_USUARIO FOREIGN KEY(ALERTA_CODIGO) REFERENCES SGC.ALERTA(CODIGO) (CAST(3 AS BIGINT))\"; SQL statement:\ninsert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?) [23506-240]] [insert into sgc.alerta_usuario (data_hora_leitura,alerta_codigo,usuario_titulo) values (?,?,?)]; SQL [insert in...

[90m[[90m1:27:37 AM[90m][39m [43m[30m WARN [39m[49m [BROWSER WARNING] [Vue warn]: Unhandled error during execution of mounted hook
  at <PainelView onVnodeUnmounted=fn<onVnodeUnmounted> ref=Ref< {} > >
  at <RouterView>
  at <App>

  âœ“   1 [chromium] â€º e2e/cdu-21.spec.ts:37:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 1: Admin cria e inicia processo de mapeamento (5.1s)
[2m[WebServer] [22m[BACKEND] INFO  LoginFacade.entrar:115: UsuÃ¡rio 141414 autorizado: CHEFE-SECAO_221
  âœ˜   2 [chromium] â€º e2e/cdu-21.spec.ts:59:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 2: Chefe adiciona atividades e disponibiliza cadastro (4.4s)
  -   3 [chromium] â€º e2e/cdu-21.spec.ts:77:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 2a: Gestor COORD_22 aceita cadastro
  -   4 [chromium] â€º e2e/cdu-21.spec.ts:83:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 2b: Gestor SECRETARIA_2 aceita cadastro
  -   5 [chromium] â€º e2e/cdu-21.spec.ts:90:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 3: Admin homologa cadastro
  -   6 [chromium] â€º e2e/cdu-21.spec.ts:102:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 4: Admin cria competÃªncias e disponibiliza mapa
  -   7 [chromium] â€º e2e/cdu-21.spec.ts:118:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 5: Chefe valida o mapa
  -   8 [chromium] â€º e2e/cdu-21.spec.ts:132:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 6: Gestor registra aceite do mapa
  -   9 [chromium] â€º e2e/cdu-21.spec.ts:147:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 6b: Gestor SECRETARIA_2 aceita mapa
  -  10 [chromium] â€º e2e/cdu-21.spec.ts:160:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 7: Admin homologa o mapa
  -  11 [chromium] â€º e2e/cdu-21.spec.ts:185:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Cenario 1: ADMIN navega para detalhes do processo
  -  12 [chromium] â€º e2e/cdu-21.spec.ts:199:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Cenario 2: ADMIN cancela finalizaÃ§Ã£o - permanece na tela
  -  13 [chromium] â€º e2e/cdu-21.spec.ts:221:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Cenario 3: ADMIN finaliza processo com sucesso
  -  14 [chromium] â€º e2e/cdu-21.spec.ts:245:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Cenario 4: Verificar ausÃªncia de botÃµes em processo finalizado


  1) [chromium] â€º e2e/cdu-21.spec.ts:59:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 2: Chefe adiciona atividades e disponibiliza cadastro

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator: getByTestId('tbl-processos').locator('tr').filter({ has: getByText('Mapeamento CDU-21 1772242051957') })
    Expected: visible
    Timeout: 3000ms
    Error: element(s) not found

    Call log:
    [2m  - Expect "toBeVisible" with timeout 3000ms[22m
    [2m  - waiting for getByTestId('tbl-processos').locator('tr').filter({ has: getByText('Mapeamento CDU-21 1772242051957') })[22m


       at helpers/helpers-analise.ts:67

      65 |     // Aguardar o processo aparecer na tabela antes de clicar
      66 |     const linhaProcesso = page.getByTestId('tbl-processos').locator('tr', {has: page.getByText(descricaoProcesso)});
    > 67 |     await expect(linhaProcesso).toBeVisible();
         |                                 ^
      68 |
      69 |     // Clicar na linha da tabela que contÃ©m o processo
      70 |     await linhaProcesso.click();
        at acessarSubprocessoChefeDireto (/app/e2e/helpers/helpers-analise.ts:67:33)
        at /app/e2e/cdu-21.spec.ts:61:9

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/cdu-21-CDU-21---Finalizar--4850d-es-e-disponibiliza-cadastro-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/cdu-21-CDU-21---Finalizar--4850d-es-e-disponibiliza-cadastro-chromium/error-context.md

  1 failed
    [chromium] â€º e2e/cdu-21.spec.ts:59:5 â€º CDU-21 - Finalizar processo de mapeamento ou de revisÃ£o â€º Preparacao 2: Chefe adiciona atividades e disponibiliza cadastro
  12 did not run
  1 passed (29.4s)
