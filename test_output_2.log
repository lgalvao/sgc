Reusing configuration cache.
> Task :backend:processTestResources UP-TO-DATE
> Task :backend:processResources UP-TO-DATE
> Task :backend:compileJava UP-TO-DATE
> Task :backend:classes UP-TO-DATE
> Task :backend:compileTestJava
> Task :backend:testClasses

> Task :backend:test

SubprocessoDetalheServicePerformanceTest > Performance: obterMapaParaAjuste should not trigger N+1 queries FAILED
    org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #7 of class path resource [data.sql]: DELETE FROM SGC.SUBPROCESSO
        at app//org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:293)
        at app//org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254)
        at app//org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:54)
        at app//org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.execute(ResourceDatabasePopulator.java:269)
        at app//org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.lambda$executeSqlScripts$5(SqlScriptsTestExecutionListener.java:371)
        at app//org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
        at app//org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
        at app//org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
        at app//org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:371)
        at app//org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.lambda$executeSqlScripts$0(SqlScriptsTestExecutionListener.java:283)
        at java.base@21.0.8/java.lang.Iterable.forEach(Iterable.java:75)
        at app//org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:283)
        at app//org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.executeSqlScripts(SqlScriptsTestExecutionListener.java:229)
        at app//org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener.beforeTestMethod(SqlScriptsTestExecutionListener.java:175)
        at app//org.springframework.test.context.TestContextManager.beforeTestMethod(TestContextManager.java:320)
        at app//org.springframework.test.context.junit.jupiter.SpringExtension.beforeEach(SpringExtension.java:282)
        at java.base@21.0.8/java.util.ArrayList.forEach(ArrayList.java:1596)
        at java.base@21.0.8/java.util.ArrayList.forEach(ArrayList.java:1596)

        Caused by:
        org.h2.jdbc.JdbcSQLIntegrityConstraintViolationException: Referential integrity constraint violation: "FK_MAPA_SUBPROCESSO: SGC.MAPA FOREIGN KEY(SUBPROCESSO_CODIGO) REFERENCES SGC.SUBPROCESSO(CODIGO) (CAST(1700 AS BIGINT))"; SQL statement:
        DELETE FROM SGC.SUBPROCESSO [23503-240]
            at app//org.h2.message.DbException.getJdbcSQLException(DbException.java:520)
            at app//org.h2.message.DbException.getJdbcSQLException(DbException.java:489)
            at app//org.h2.message.DbException.get(DbException.java:223)
            at app//org.h2.message.DbException.get(DbException.java:199)
            at app//org.h2.constraint.ConstraintReferential.checkRow(ConstraintReferential.java:363)
            at app//org.h2.constraint.ConstraintReferential.checkRowRefTable(ConstraintReferential.java:380)
            at app//org.h2.constraint.ConstraintReferential.checkRow(ConstraintReferential.java:254)
            at app//org.h2.table.Table.fireConstraints(Table.java:1208)
            at app//org.h2.table.Table.fireAfterRow(Table.java:1226)
            at app//org.h2.command.dml.Delete.update(Delete.java:81)
            at app//org.h2.command.dml.DataChangeStatement.update(DataChangeStatement.java:77)
            at app//org.h2.command.CommandContainer.update(CommandContainer.java:139)
            at app//org.h2.command.Command.executeUpdate(Command.java:306)
            at app//org.h2.command.Command.executeUpdate(Command.java:250)
            at app//org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:262)
            at app//org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:231)
            at app//com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95)
            at app//com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java)
            at app//org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:261)
            ... 17 more
  Results: FAILURE
  Total:     1 tests run
  ✓ Passed:  0
  ✗ Failed:  1
  ○ Ignored: 0
  Time:     27.408s

1 test completed, 1 failed

> Task :backend:test FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':backend:test'.
> There were failing tests. See the report at: file:///app/backend/build/reports/tests/test/index.html

* Try:
> Run with --scan to generate a Build Scan (powered by Develocity).

BUILD FAILED in 35s
5 actionable tasks: 2 executed, 3 up-to-date
Configuration cache entry reused.
