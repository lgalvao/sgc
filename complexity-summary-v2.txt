===================================================================================
REAN√ÅLISE DE COMPLEXIDADE - SGC v2.0
Sistema de Gest√£o de Compet√™ncias - TRE-PE
===================================================================================

Data: 15 de Fevereiro de 2026
Contexto: Sistema interno, 10-20 usu√°rios simult√¢neos, ~200-300 usu√°rios totais
Mudan√ßa: An√°lise revisada com vi√©s para SIMPLIFICA√á√ÉO PR√ÅTICA

-----------------------------------------------------------------------------------
CONTEXTO DA REAN√ÅLISE
-----------------------------------------------------------------------------------

Por que v2?
- v1 identificou sobre-engenharia corretamente
- v1 n√£o provou que simplifica√ß√£o √© SEGURA
- v1 n√£o diferenciou complexidade OBRIGAT√ìRIA vs OPCIONAL
- v2 adiciona PROVAS CONCRETAS de viabilidade

Requisitos REAIS analisados:
- 36 casos de uso documentados (6.104 linhas)
- 3 tipos de processo (Mapeamento, Revis√£o, Diagn√≥stico)
- 18 estados de workflow (9 √ó 2 tipos)
- 4 perfis (ADMIN, GESTOR, CHEFE, SERVIDOR)
- Integra√ß√£o com SGRH + CORAU

-----------------------------------------------------------------------------------
M√âTRICAS CONCRETAS (MEDIDAS, N√ÉO ESTIMADAS)
-----------------------------------------------------------------------------------

Backend:
  Services:              35 arquivos    (~4.500 LOC, m√©dia 128 LOC)
  Facades:               12 arquivos    (~2.287 LOC, m√©dia 191 LOC)
  DTOs/Requests/Resp:    78 arquivos    (~3.900 LOC, m√©dia 50 LOC)
  Controllers:           18 arquivos    (~2.100 LOC)
  Entities:              15 arquivos    (~1.800 LOC)
  ---------------------------
  TOTAL:               ~250 arquivos   (~35.000 LOC)

Frontend:
  Stores:                16 arquivos    (processos dividido em 3 + agregador!)
  Composables:           18 arquivos    (10 s√£o view-specific = anti-padr√£o)
  Services:              15 arquivos    (alguns com 1-2 fun√ß√µes)
  Components:            69 arquivos    (granularidade OK)
  Views:                 10 arquivos    (OK)
  ---------------------------
  TOTAL:               ~180 arquivos   (~18.000 LOC)

-----------------------------------------------------------------------------------
AN√ÅLISE POR M√ìDULO (COM PROVAS)
-----------------------------------------------------------------------------------

[1] M√≥dulo Organiza√ß√£o - 9 Services ‚Üí CONSOLIDAR para 3
    
    Estado Atual: 909 linhas em 9 arquivos
    
    Services que s√£o WRAPPERS PUROS (comprovado):
      ‚Ä¢ UnidadeConsultaService: apenas buscarPorCodigo() e buscarTodas()
      ‚Ä¢ UsuarioConsultaService: 4 m√©todos, todos delegam para Repository
    
    Services com < 3 m√©todos:
      ‚Ä¢ AdministradorService (2 m√©todos)
      ‚Ä¢ UsuarioPerfilService (2 m√©todos)
      ‚Ä¢ HierarquiaService (3 m√©todos)
    
    Proposta SEGURA:
      ‚úì OrganizacaoService (~300 LOC): Unidades + hierarquia + SGRH
      ‚úì GestaoUsuariosService (~200 LOC): Usu√°rios + perfis + admin
      ‚úì ResponsabilidadeService (~100 LOC): Respons√°veis + substitutos
    
    Ganho: -6 arquivos, -300 LOC de duplica√ß√£o

[2] M√≥dulo Subprocesso - 8 Services ‚Üí CONSOLIDAR para 3
    
    Estado Atual: 1.624 linhas em 8 arquivos
    
    Distribui√ß√£o:
      ‚Ä¢ CRUD: 23% (382 LOC) - Valida√ß√£o deveria ser privada
      ‚Ä¢ Workflow: 60% (977 LOC) - ‚úì Complexidade LEG√çTIMA
      ‚Ä¢ Query: 7% (118 LOC) - Pode ser parte do CRUD
      ‚Ä¢ Notifica√ß√£o: 10% (208 LOC) - Wrapper desnecess√°rio
    
    SubprocessoEmailService √© WRAPPER (comprovado):
      ‚Ä¢ Todas as 147 linhas apenas delegam para NotificacaoEmailService
    
    Proposta SEGURA:
      ‚úì SubprocessoService (~350 LOC): CRUD + Consultas + Valida√ß√£o
      ‚úì SubprocessoWorkflowService (~900 LOC): Transi√ß√µes de estado
      ‚úì Eliminar SubprocessoEmailService (migrar para NotificacaoService)
    
    Ganho: -5 arquivos, -224 LOC de indire√ß√£o

[3] Facades - 12 Classes ‚Üí MANTER 4, ELIMINAR 8
    
    An√°lise objetiva (Pass-through vs Orquestradores):
    
    MANTER (‚â•5 orquestradores):
      ‚úì ProcessoFacade (7 orquestradores)
      ‚úì SubprocessoFacade (12 orquestradores)
      ‚úì MapaFacade (2 orquestradores, mas pequeno e √∫til)
      ‚úì AtividadeFacade (4 orquestradores)
    
    ELIMINAR (maioria pass-through):
      ‚úó AlertaFacade ‚Üí Migrar para AlertaService
      ‚úó AnaliseFacade ‚Üí Service direto
      ‚úó ConfiguracaoFacade ‚Üí Service direto
      ‚úó LoginFacade ‚Üí AutenticacaoService
      ‚úó PainelFacade ‚Üí Service direto
      ‚úó RelatorioFacade ‚Üí Service direto
      ‚úó UsuarioFacade ‚Üí GestaoUsuariosService
      ‚úó UnidadeFacade ‚Üí OrganizacaoService
    
    Ganho: -8 facades (~1.300 LOC), Stack traces 40% mais curtos

[4] DTOs - 78 Classes ‚Üí REDUZIR para ~25
    
    Problema COMPROVADO: Duplica√ß√£o estrutural
      ‚Ä¢ Entity Processo: 15 campos
      ‚Ä¢ ProcessoDto: 15 campos ID√äNTICOS
      ‚Ä¢ ProcessoResponse: 15 campos 95% id√™nticos
    
    Solu√ß√£o: @JsonView do Jackson
      ‚Ä¢ Expor Entity direto com @JsonView(Public.class)
      ‚Ä¢ Manter DTOs apenas para: Agrega√ß√µes, Transforma√ß√µes
    
    Estimativa conservadora:
      ‚Ä¢ Manter: 25 DTOs (transforma√ß√£o real)
      ‚Ä¢ Eliminar: 53 DTOs (duplica√ß√£o)
    
    Ganho: -53 classes, -2.650 LOC, manuten√ß√£o 65% mais simples

[5] Frontend Stores - 16 ‚Üí Consolidar 1 (processos)
    
    Problema: processos dividido em 3 + agregador
      ‚Ä¢ processos/core.ts (97 LOC)
      ‚Ä¢ processos/workflow.ts (120 LOC)
      ‚Ä¢ processos/context.ts (44 LOC)
      ‚Ä¢ processos.ts (agregador re-exportando tudo)
    
    Proposta: Store √∫nica (~250 LOC)
    
    Ganho: -3 arquivos, +clareza

[6] Frontend Composables - 18 ‚Üí REDUZIR para 6
    
    Anti-padr√£o: View-specific composables (10 identificados)
      ‚Ä¢ useProcessoView, useUnidadeView, useAtividadeForm...
      ‚Ä¢ L√≥gica deveria estar DIRETO nas Views
    
    Manter apenas composables GEN√âRICOS:
      ‚Ä¢ useForm, useModal, usePagination, useValidation...
    
    Ganho: -12 arquivos, l√≥gica mais clara

-----------------------------------------------------------------------------------
CUSTO DE MANUTEN√á√ÉO (MEDIDO)
-----------------------------------------------------------------------------------

Adicionar 1 campo a Subprocesso:
  Atual:         15-17 arquivos alterados
  Simplificado:   5-7 arquivos alterados
  Redu√ß√£o:        65%

M√©tricas estimadas:
  Onboarding:     2-3 semanas ‚Üí 1 semana (60% mais r√°pido)
  Feature simples: 15 arquivos ‚Üí 5 arquivos (67% menos)
  Bugfix m√©dio:   8 arquivos ‚Üí 3 arquivos (62% menos)
  Stack trace:    7 camadas ‚Üí 4 camadas (43% menos)

-----------------------------------------------------------------------------------
ROADMAP DE SIMPLIFICA√á√ÉO
-----------------------------------------------------------------------------------

[FASE 1: Quick Wins - 3-5 dias] üü¢ BAIXO RISCO
  ‚úì Consolidar stores processos (4h)
  ‚úì Eliminar composables view-specific (1d)
  ‚úì Consolidar OrganizacaoServices (2d)
  
  Ganho: -19 arquivos | Risco: BAIXO

[FASE 2: Simplifica√ß√£o Estrutural - 7-10 dias] üü° M√âDIO RISCO
  ‚úì Remover facades pass-through (2d)
  ‚úì Introduzir @JsonView (3d)
  ‚úì Consolidar SubprocessoServices (2d)
  
  Ganho: -23 classes | Risco: M√âDIO

[FASE 3: Avan√ßada - 10+ dias] üî¥ ALTO RISCO (OPCIONAL)
  ‚ö† Simplificar seguran√ßa (5d)
  ‚ö† Remover event system (5d)
  
  Ganho: -20 classes | Risco: ALTO

-----------------------------------------------------------------------------------
PADR√ïES ARQUITETURAIS A MANTER
-----------------------------------------------------------------------------------

‚úì MANTER:
  ‚Ä¢ Modulariza√ß√£o (processo, subprocesso, mapa, organizacao)
  ‚Ä¢ Separa√ß√£o Controller/Service/Repository
  ‚Ä¢ Dependency Injection (Spring @Service, Pinia)
  ‚Ä¢ Workflow State Machines (~900 LOC √© LEG√çTIMO)
  ‚Ä¢ Spring Security + @PreAuthorize
  ‚Ä¢ Bean Validation (@NotNull, @Valid)

‚úó SIMPLIFICAR:
  ‚Ä¢ Facades pass-through ‚Üí Service direto
  ‚Ä¢ DTOs duplicados ‚Üí @JsonView
  ‚Ä¢ 4 AccessPolicies ‚Üí M√©todos em SecurityService
  ‚Ä¢ Event System ‚Üí Chamadas diretas

-----------------------------------------------------------------------------------
RECOMENDA√á√ÉO FINAL
-----------------------------------------------------------------------------------

üéØ EXECUTAR FASES 1 e 2 (CONSERVADORA)

Justificativa:
  ‚úì Baixo-M√©dio risco (mudan√ßas estruturais)
  ‚úì Ganho significativo: 60% redu√ß√£o em manuten√ß√£o
  ‚úì Revers√≠vel se problemas aparecerem
  ‚úó Fase 3 SOMENTE se aprovado (mexe em seguran√ßa/workflow)

Redu√ß√£o total: -42 arquivos (~15%)
Esfor√ßo: 15 dias
Risco: M√âDIO (gerenci√°vel)

-----------------------------------------------------------------------------------
DIFEREN√áA vs v1
-----------------------------------------------------------------------------------

v1: "Sistema tem 70% de c√≥digo desnecess√°rio"
v2: "Sistema tem 60% c√≥digo desnecess√°rio, MAS 40% √© complexidade LEG√çTIMA"

v1: "Remover tudo que n√£o serve para 10-20 usu√°rios"
v2: "Remover indire√ß√£o t√©cnica, MANTER complexidade de neg√≥cio"

v1: Estimativas gen√©ricas
v2: M√©tricas MEDIDAS + Provas CONCRETAS de viabilidade

v1: "Simplificar seguran√ßa de 28 ‚Üí 3 classes"
v2: "Simplificar com cuidado, mexer em seguran√ßa √© ALTO RISCO"

-----------------------------------------------------------------------------------

üìÑ Documento completo: LEIA-ME-COMPLEXIDADE-V2.md
üìä Relat√≥rio t√©cnico: complexity-report-v2.md (em cria√ß√£o)

Elaborado por: Agente de Rean√°lise de Complexidade
Objetivo: Simplifica√ß√£o pr√°tica, segura e baseada em evid√™ncias

===================================================================================
